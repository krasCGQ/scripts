# shellcheck shell=bash
# Treewide environment setup
# Copyright (C) 2017-2019 Albert I (krasCGQ)
# SPDX-License-Identifier: GPL-3.0-or-later

# Text styles
if [[ -n $(command -v tput) ]]; then
    BLD=$(tput bold)
    RST=$(tput sgr0)
else
    BLD='\033[1m'
    RST='\033[0m'
fi
# Export variables to satisfy shellcheck requirements
export BLD RST

# Enable escape sequences on Bash
[[ -n $BASH ]] && alias echo='echo -e'

# Prints a message with a dash
prInfo() {
    echo "- $1"
    while [[ $# -ge 2 ]]; do
        echo "  $2"
        shift
    done
}

# Prints a message with an exclamation point
prWarn() {
    echo "! $1" >&2
    while [[ $# -ge 2 ]]; do
        echo "  $2" >&2
        shift
    done
}

# Making sure user has sudo before executing command
chkSudo() {
    [[ -n $IS_TERMUX ]] && { prInfo "This function is unnecessary on Termux; go ahead." && return; }

    prInfo "Checking for sudo; please enter password if prompted."
    if ! sudo -v 2>/dev/null; then
        prWarn "Current user isn't a sudoer!"
        return 1
    fi

    # Prevent falsely returning non-zero status
    if [[ $# != 0 ]]; then sudo "$@"; fi
}

# Check for system architecture support
chkArch() {
    ARCH=$(uname -m)
    for TARGET in "$@"; do
        [[ $ARCH == "$TARGET" ]] && return
    done
    return 1
}
